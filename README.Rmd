```{r knitsetup, echo=FALSE, results='hide', warning=FALSE, message=FALSE, cache=FALSE}
library(knitr)
opts_knit$set(base.dir='./', fig.path='', out.format='md')
opts_chunk$set(prompt=FALSE, comment='', results='markup')
# See yihui.name/knitr/options for more Knitr options.
##### Put other setup R code here

```

# rlist

[![Build Status](https://travis-ci.org/renkun-ken/rlist.png?branch=master)](https://travis-ci.org/renkun-ken/rlist)

rlist is a set of tools for working with list objects. It has two main goals:

- Make it easier to work with list objects used to store data in more flexible structures than data frames.
- Perform a wide range of functions on non-relational data using list constructs.

[Release notes](https://github.com/renkun-ken/rlist/releases)

*Notice: Currently, this package may not be stable enough for production purpose. Its functions and implmentations may change overtime and cannot guarantee the backward compatibility at the moment. Please be cautious when you use it in production.*

## Installation

Install from CRAN with

```r
install.packages("rlist")
```

or install the latest development version from GitHub with

```r
devtools::install_github("rlist","renkun-ken")
```

## Functions

The package provides a wide range of functions to work with list objects.

Suppose we have a list of developers, each of whom has a name, age, a few interests, a list of programming languages they use and the number of years they have been using them.

```{r}
library(rlist)
devs <- 
  list(
    p1=list(name="Ken",age=24,
      interest=c("reading","music","movies"),
      lang=list(r=2,csharp=4,python=3)),
    p2=list(name="James",age=25,
      interest=c("sports","music"),
      lang=list(r=3,java=2,cpp=5)),
    p3=list(name="Penny",age=24,
      interest=c("movies","reading"),
      lang=list(r=1,cpp=4,python=2)))
```

This type of data can be easily stored in JSON or YAML format.

### Filtering

Filter members whose age is no less than 25 by calling `list.filter`.

```{r}
str(list.filter(devs,age >= 25))
```

### Mapping

Get the name of each person by calling `list.map` that maps each member by an expression.

```{r}
list.map(devs, name)
```

Get the programming language each person has been using for the longest time by calling `list.map`.

```{r}
list.map(devs, sort(unlist(lang),decreasing = T)[1])
```

### Selecting

Select the name and age of each member by calling `list.select`.

```{r}
str(list.select(devs,name,age))
```

Select the name and evaluate the range of the number of years using programming languages.

```{r}
str(list.select(devs,name,range=range(unlist(lang))))
```

### Grouping

Build a list that contains sublists each represents an age group by calling `list.group`.

```{r}
str(list.group(devs,age))
```

### Sorting

Sort the developers by the number of interests in descending order, then by the number of years they have been using R in descending order by calling `list.sort`.

```{r}
sorted <- list.sort(devs,desc(length(interest)),desc(lang$r))
list.map(sorted,name)
```

### Updating

Use `list.update` to update the list by removing `age` and `lang` columns and introducing the number of languages each member uses as `nlang`.

```{r}
str(list.update(devs,age=NULL,lang=NULL,nlang=length(lang)))
```

### More functions

Much more functions are provided than the examples show. Please read the documentation of the package.

### Working with pipeline

Pipeline operators may hugely improve the readability of the code especially when a chain of commands are executed. [pipeR package](http://renkun.me/pipeR) is recommended to co-work with this package.

If we want to know the developers whose age is no more than 24 and create a data frame where they are sorted by the number of years using R in descending order and each row tells us the name, years of using R, and the longest time using a language they know.

```{r}
library(pipeR)
devs %>>%
  list.filter(age <= 24) %>>%
  list.sort(desc(lang$r)) %>>%
  list.map(data.frame(name=name,r=lang$r,
    longest=max(unlist(lang)))) %>>%
  list.rbind
```

### Lambda expression

In this package, all functions that work with expressions support the following forms of lambda expressions, for example,

- `x ~ g(x)`
- `x -> g(x)`
- `f(x) -> g(x)`
- `f(x,i) -> g(x,i)`
- `f(x,i,name) -> g(x,i,name)`

where `x` refers to the list member itself, `i` denotes the index, `name` denotes the name. If the symbols are not explicitly declared, `.`, `.i` and `.name` will by default be used to represent them, respectively.

```{r}
nums <- list(a=c(1,2,3),b=c(2,3,4),c=c(3,4,5))
nums %>>%
  list.map(data.frame(min=min(.),max=max(.))) %>>%
  list.rbind
nums %>>% list.mapv(x ~ sum(x))
nums %>>% list.filter(x -> mean(x)>=3)
nums %>>% list.mapv(f(x,i) -> sum(x,i))
```

## Help overview

```r
help(package = rlist)
```

## License

This package is under [MIT License](http://opensource.org/licenses/MIT).
