<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{List searching}
-->

```{r, echo = FALSE, message = FALSE}
knitr::opts_chunk$set(comment="#",error=FALSE,tidy=FALSE)
```

# List searching

rlist provides searching capabilities, that is, find values within a list without specifying the key or searching path. `list.search` handles a variety of searching demands.


## Exact searching

Exact searching is the default searching mechanism. Suppose we search the following list.

```{r}
x <- list(p1 = list(type="A",score=list(c1=10,c2=8)),
    p2 = list(type="B",score=list(c1=9,c2=9)),
    p3 = list(type="B",score=list(c1=9,c2=7)))
str(x)
```

First, we search all `"A"` values in the list.

```{r}
list.search(x,"A")
```

Only values that all equals this value will be put in the resulting list. We can also unlist the result.

```{r}
list.search(x,"A",unlist = TRUE)
```

Then, we search all value `9`.

```{r}
list.search(x, 9)
```

or unlisted results

```{r}
list.search(x, 9, unlist = TRUE)
```

## Case searching

Sometimes the values are vectors and we want to search the fields that include a value instead of being equal. This is called case searching.

Suppose we have the following data.

```{r}
x <- list(p1 = list(x=c("A","B","C"),y=list(y1="A",y2=c("B","C"))),
    p2 = list(a=c("A","B"),b=list(b1=c("B","C"),b2=list("C","B"))))
str(x)
```

To search all character vectors that include value `"A"`, we need to specify `fun = "%in%"` so that the comparison is done by `%in%` operator.

```{r}
list.search(x,"A","%in%")
```

## Fuzzy searching

The comparison is flexible enough to support fuzzy searching using functions provided by [`stringdist`](http://cran.r-project.org/web/packages/stringdist/index.html) package. Consider the following list.

```{r}
x <- list(
    p1 = list(name="Ken",age=24),
    p2 = list(name="Kent",age=26),
    p3 = list(name="Sam",age=24),
    p4 = list(name="Keynes",age=30),
    p5 = list(name="Kwen",age=31))
```

rlist's built-in functions `anyLike(dist,...)` and `allLike(dist,...)` that internally call `stringdist::ain` and `stringdist::stringdist` can handle fuzzy searching to meet a wide range of demands. 

For both functions, `dist` means the maximum string distance between the actual value in the list and the search term you specify, and `...` is the additional parameters passed to their internally called functions. More specifically,

- `allLike(1)` means the string distances of **ALL** values in the character vector must be no greater than one to be qualified as a search result.
- `anyLike(1)` means that **ANY** value in the character vector in the list whose string distance is no greater than one will make the vector qualified as a search result.

Similar logic also applies to `allUnlike()` and `anyUnlike()`.

For example, if we want to find out names similar with `"Ken"` with maximum distance 1, we only have to specify `fun = allLike(1)`.

```{r}
list.search(x,"ken",allLike(1),unlist = TRUE)
```

`anyLike(dist)` is the counterpart of `allLike(dist)` functioning similar with `%in%` operator. It tells whether a character vector includes a similar value within a specific range of distance.

```{r}
x <- list(
    p1 = list(name=c("Ken", "Ren"),age=24),
    p2 = list(name=c("Kent", "Potter"),age=26),
    p3 = list(name=c("Sam", "Lee"),age=24),
    p4 = list(name=c("Keynes", "Bond"),age=30),
    p5 = list(name=c("Kwen", "Hu"),age=31))
list.search(x,"Ken", anyLike(1))
list.search(x,"Ken", allUnlike(2))
```
